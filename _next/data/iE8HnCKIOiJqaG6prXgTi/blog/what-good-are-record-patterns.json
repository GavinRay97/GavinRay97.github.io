{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var p=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var o=e=>l(e,\"__esModule\",{value:!0});var k=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports),N=(e,s)=>{o(e);for(var c in s)l(e,c,{get:s[c],enumerable:!0})},w=(e,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let a of m(s))!u.call(e,a)&&a!==\"default\"&&l(e,a,{get:()=>s[a],enumerable:!(c=d(s,a))||c.enumerable});return e},f=e=>w(o(l(e!=null?p(h(e)):{},\"default\",e&&e.__esModule&&\"default\"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var r=k((C,i)=>{i.exports=_jsx_runtime});var b={};N(b,{default:()=>v,frontmatter:()=>g});var n=f(r()),g={title:\"What good are Record Patterns in Java? An example based on Spark's Catalyst Optimizer and it's Tree Rewriting Rules\",date:\"2023-02-04\",tags:[\"java\",\"jdk\",\"jvm\"],draft:!1,summary:`A tutorial on how to use Java's new Record Patterns feature to write powerful, concise pattern matching code for usecases like AST transformations and rewrite-rules in compiler passes.\n`,images:[\"/static/images/ast-visualization.png\"]};function y(e={}){let{wrapper:s}=e.components||{};return s?(0,n.jsx)(s,Object.assign({},e,{children:(0,n.jsx)(c,{})})):c();function c(){let a=Object.assign({hr:\"hr\",h1:\"h1\",a:\"a\",span:\"span\",p:\"p\",code:\"code\",h2:\"h2\",pre:\"pre\",ol:\"ol\",li:\"li\",ul:\"ul\"},e.components),{TOCInline:t}=a;return t||x(\"TOCInline\",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t,{toc:e.toc,indentDepth:2,asDisclosure:!0}),(0,n.jsx)(a.hr,{}),(0,n.jsxs)(a.h1,{id:\"preface\",children:[(0,n.jsx)(a.a,{href:\"#preface\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"Preface\"]}),(0,n.jsxs)(a.p,{children:[\"Recently, Gunnar Morling made a stellar \",(0,n.jsx)(a.a,{href:\"https://twitter.com/gunnarmorling/status/1619412551200301057\",children:\"tweet\"}),\" about how he was interested in hearing of usecases for Java's new \",(0,n.jsx)(a.a,{href:\"https://openjdk.org/jeps/405\",children:\"Record Patterns\"}),\" feature. My dayjob involves a lot of work with AST/IR and a sort of \",(0,n.jsx)(a.code,{children:\"Query Expression Language\"}),\", so I immediately grew excited at being able to share this sort of usecase with the community.\"]}),(0,n.jsxs)(\"blockquote\",{className:\"twitter-tweet\",children:[(0,n.jsx)(\"span\",{lang:\"en\",dir:\"ltr\",children:(0,n.jsxs)(a.p,{children:[\"Playing around a bit with \",(0,n.jsx)(\"a\",{href:\"https://twitter.com/hashtag/Java?src=hash&ref_src=twsrc%5Etfw\",children:\"#Java\"}),\" 19/20 record patterns. I generally like the ergonomics of it, matching whole object trees is kinda fun. \",(0,n.jsx)(a.code,{children:\"var\"}),\" helps to gloss over irrelevant parts of the tree, might be even more concise though? Also curious what use cases folks see for this. \",(0,n.jsx)(\"a\",{href:\"https://t.co/v4NKUu6Cz7\",children:\"pic.twitter.com/v4NKUu6Cz7\"})]})}),(0,n.jsxs)(a.p,{children:[\"\\u2014 Gunnar Morling \\u{1F30D} (@gunnarmorling) \",(0,n.jsx)(\"a\",{href:\"https://twitter.com/gunnarmorling/status/1619412551200301057?ref_src=twsrc%5Etfw\",children:\"January 28, 2023\"})]})]}),(0,n.jsx)(\"script\",{async:!0,src:\"https://platform.twitter.com/widgets.js\",charSet:\"utf-8\"}),(0,n.jsxs)(a.h1,{id:\"what-are-record-patterns\",children:[(0,n.jsx)(a.a,{href:\"#what-are-record-patterns\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"What are Record Patterns?\"]}),(0,n.jsx)(a.p,{children:\"Record Patterns are a new feature in Java 19/20 that allow you to write concise, powerful pattern matching code.\"}),(0,n.jsxs)(a.p,{children:['\"Pattern Matching\" is a term adopted from the \"Functional Programming\" world, and is a way of expressing a conditional statement in a declarative way. Rather than writing a series of ',(0,n.jsx)(a.code,{children:\"if\"}),\"/\",(0,n.jsx)(a.code,{children:\"else if\"}),\"/\",(0,n.jsx)(a.code,{children:\"else\"}),\" statements, you can write a series of patterns that match against the input, and execute a block of code when a pattern matches.\"]}),(0,n.jsxs)(a.p,{children:[\"This simple principle is tremendously powerful, due to the flexibility in how patterns can be used. Though this is heavily dependent on whether the patterns allow you to \",(0,n.jsx)(a.code,{children:\"nest\"}),\" them, and to \",(0,n.jsx)(a.code,{children:\"bind\"}),` variables to the matched values (as we'll see below in a moment). Let's take a look at some examples of \"traditional\" POJO code, and how we might rewrite it using Records and Record Patterns using more \"modern\" Java with declarative style.`]}),(0,n.jsxs)(a.h1,{id:\"a-simple-example\",children:[(0,n.jsx)(a.a,{href:\"#a-simple-example\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"A Simple Example\"]}),(0,n.jsxs)(a.p,{children:[\"Let's start with a simple example of a \",(0,n.jsx)(a.code,{children:\"Person\"}),\" class, which has a \",(0,n.jsx)(a.code,{children:\"name\"}),\" and \",(0,n.jsx)(a.code,{children:\"age\"}),\":\"]}),(0,n.jsxs)(a.h2,{id:\"a-person-pojo-what-youre-used-to\",children:[(0,n.jsx)(a.a,{href:\"#a-person-pojo-what-youre-used-to\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"A Person POJO, what you're used to\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"final\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" age\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" age\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"name \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"age \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" age\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getName\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getAge\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" age\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"Now, let's write a simple function that takes a \",(0,n.jsx)(a.code,{children:\"Person\"}),\" and returns a \",(0,n.jsx)(a.code,{children:\"String\"}),\" based on their age:\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getPersonStatus\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),\" person\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"person\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getAge\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"18\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"Minor\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"person\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"getAge\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"65\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"Adult\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"Senior\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.h2,{id:\"lets-rewrite-it-with-records-and-record-patterns\",children:[(0,n.jsx)(a.a,{href:\"#lets-rewrite-it-with-records-and-record-patterns\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"Let's rewrite it with Records and Record Patterns\"]}),(0,n.jsxs)(a.p,{children:[\"This is a simple example, but it's already starting to get a bit messy. We have to write a lot of boilerplate code, and we have to repeat the \",(0,n.jsx)(a.code,{children:\"person.getAge()\"}),\" call multiple times. Let's see how we can rewrite this using Record Patterns:\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" age\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getPersonStatus\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),\" person\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"person\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" _\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" age\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when age \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"18\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"Minor\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" _\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" age\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when age \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"<\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"65\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"Adult\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token string\",children:'\"Senior\"'}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.h2,{id:\"what-else-can-we-do\",children:[(0,n.jsx)(a.a,{href:\"#what-else-can-we-do\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"What else can we do?\"]}),(0,n.jsx)(a.p,{children:\"That's a lot better!\"}),(0,n.jsx)(a.p,{children:\"This is just the tip of the iceberg though. We can do lots of things in patterns like:\"}),(0,n.jsxs)(a.ol,{children:[(0,n.jsx)(a.li,{children:\"Use interface/superclass types in patterns, which will match based on specificity\"}),(0,n.jsxs)(a.li,{children:[\"Nest patterns in our \",(0,n.jsx)(a.code,{children:\"case\"}),\" statements\"]})]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"sealed\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"interface\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Shape\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"permits\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Circle\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Rectangle\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Square\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Circle\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"double\"}),\" radius\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Shape\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Rectangle\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"double\"}),\" width\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"double\"}),\" height\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Shape\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Square\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"double\"}),\" side\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Shape\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"double\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getArea\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Shape\"}),\" shape\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"shape\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Circle\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" radius\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Math\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"PI \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"*\"}),\" radius \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"*\"}),\" radius\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Rectangle\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" width\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" height\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" width \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"*\"}),\" height\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Square\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" side\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" side \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"*\"}),\" side\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"PhoneNumber\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" countryCode\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" areaCode\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" number\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" age\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"PhoneNumber\"}),\" phoneNumber\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:`// I'm using \"_\" for readability here, this won't compile`}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"getPeopleWithAreaCode\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" people\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" areaCode\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" people\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"stream\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"filter\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"person \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"person\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Silly example for demo, doesn't make a lot of sense\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Person\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"_\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" _\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"PhoneNumber\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"_\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" areaCode\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" _\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token boolean\",children:\"false\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"toList\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.h1,{id:\"the-usecase-tree-rewritingast-transformations\",children:[(0,n.jsx)(a.a,{href:\"#the-usecase-tree-rewritingast-transformations\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"The Usecase: Tree Rewriting/AST Transformations\"]}),(0,n.jsx)(a.p,{children:\"Now that we've seen some examples of how Record Patterns can be used, let's take a look at a real-world usecase for them: Tree Rewriting/AST Transformations.\"}),(0,n.jsxs)(a.h2,{id:\"what-is-tree-rewriting\",children:[(0,n.jsx)(a.a,{href:\"#what-is-tree-rewriting\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"What is Tree Rewriting?\"]}),(0,n.jsx)(a.p,{children:\"Tree rewriting is a technique used in compilers to transform the AST/IR of a program. This is done by writing a series of rewrite rules that match against the AST, and then rewrite the AST based on the matched rules.\"}),(0,n.jsxs)(a.p,{children:[\"For example, let's say we have a simple \",(0,n.jsx)(a.code,{children:\"Expression\"}),\" AST:\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"sealed\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"interface\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"permits\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"We can then write a simple \",(0,n.jsx)(a.code,{children:\"eval\"}),\" function that evaluates the expression, given a map of variable names to values (the \",(0,n.jsx)(a.code,{children:\"enviroment\"}),\"):\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Evaluator\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Integer\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"get\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"A rewrite-rule would be a pattern that matches against the \",(0,n.jsx)(a.code,{children:\"Expr\"}),\" AST, and then rewrites it to a new \",(0,n.jsx)(a.code,{children:\"Expr\"}),\" AST. For example, we could write a rule that rewrites \",(0,n.jsx)(a.code,{children:\"x + 0\"}),\" to just \",(0,n.jsx)(a.code,{children:\"x\"}),\".\"]}),(0,n.jsxs)(a.p,{children:[\"In the Apache Spark project, the Scala language makes it incredibly easy to write such rules using \",(0,n.jsx)(a.code,{children:\"case classes\"}),\" and \",(0,n.jsx)(a.code,{children:\"case\"}),\" statements. The \",(0,n.jsx)(a.a,{href:\"https://github.com/apache/spark/blob/master/sql/catalyst/src/main/scala/org/apache/spark/sql/catalyst/optimizer/Optimizer.scala\",children:\"Catalyst optimizer code\"}),\" is full of such rewrite rules, and it's a joy to read.\"]}),(0,n.jsxs)(a.h2,{id:\"how-can-record-patterns-help\",children:[(0,n.jsx)(a.a,{href:\"#how-can-record-patterns-help\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"How can Record Patterns help?\"]}),(0,n.jsxs)(a.p,{children:[\"Let's take the above example of a rule that rewrites \",(0,n.jsx)(a.code,{children:\"x + 0\"}),\" to just \",(0,n.jsx)(a.code,{children:\"x\"}),\".\"]}),(0,n.jsxs)(a.p,{children:[\"We can write this rule as follows, using Record Patterns (going a bit further than just \",(0,n.jsx)(a.code,{children:\"x + 0\"}),\", to cover some more cases):\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"SimplifyZeroOpPass\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"simplify\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// x + 0 = x\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when value \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// 0 + x = x\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when value \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// x - 0 = x\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when value \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// x * 1 = x\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when value \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// 1 * x = x\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when value \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// x / 1 = x\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when value \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// 0 / x = 0\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"var\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" when value \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Otherwise, just return the expression\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"default\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.p,{children:[\"Can you imagine if we had to write this using traditional \",(0,n.jsx)(a.code,{children:\"instanceof\"}),\" and \",(0,n.jsx)(a.code,{children:\"if\"}),\" statements? It would be a nightmare!\"]}),(0,n.jsx)(a.p,{children:\"It would be something like this (Not checked for accuracy):\"}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"SimplifyZeroOpPass\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"simplify\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),\" add\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"add\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"left\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" leftVar \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" add\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"right\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" rightConst \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" rightConst\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" leftVar\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"add\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"left\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" leftConst \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" add\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"right\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" rightVar \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" leftConst\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" rightVar\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),\" sub\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"sub\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"left\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" leftVar \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" sub\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"right\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" rightConst \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" rightConst\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" leftVar\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),\" mul\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"mul\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"left\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" leftVar \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" mul\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"right\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" rightConst \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" rightConst\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" leftVar\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"mul\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"left\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" leftConst \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" mul\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"right\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" rightVar \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" leftConst\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" rightVar\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),\" div\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"div\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"left\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" leftVar \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" div\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"right\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" rightConst \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" rightConst\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" leftVar\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"div\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"left\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" leftConst \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" div\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"right\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"instanceof\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" rightVar \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"&&\"}),\" leftConst\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.h2,{id:\"implementing-the-rewriter\",children:[(0,n.jsx)(a.a,{href:\"#implementing-the-rewriter\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"Implementing the Rewriter\"]}),(0,n.jsx)(a.p,{children:\"To wrap up, I'm going to share the implementation of a full program that provides a multi-pass expression simplifier, using Record Patterns.\"}),(0,n.jsxs)(a.p,{children:[\"This is going to be a little bit of a \",(0,n.jsx)(a.a,{href:\"https://knowyourmeme.com/memes/how-to-draw-an-owl\",children:\"Draw the rest of the owl\"}),\" situation, because I feel like the above has already covered the majority of what background the reader needs for understanding the code.\"]}),(0,n.jsx)(a.p,{children:\"What we're going to do is write a program that takes a mathematical expression, and simplifies it using a series of rewrite rules.\"}),(0,n.jsx)(a.p,{children:\"Our two rewrite rules will be:\"}),(0,n.jsxs)(a.ol,{children:[(0,n.jsxs)(a.li,{children:[\"Constant Folding -- convert any expression like \",(0,n.jsx)(a.code,{children:\"Add(Const(1), Const(2))\"}),\" to \",(0,n.jsx)(a.code,{children:\"Const(3)\"}),\".\"]}),(0,n.jsxs)(a.li,{children:[\"Replace all \",(0,n.jsx)(a.code,{children:\"Const(x)\"}),\" with \",(0,n.jsx)(a.code,{children:\"Const(42)\"})]})]}),(0,n.jsxs)(a.p,{children:[\"If we run the below on Java 21 with \",(0,n.jsx)(a.code,{children:\"--enable-preview\"}),\":\"]}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewriter\"}),\" rewriter \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewriter\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ConstantFoldingPass\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ConstantRewritingPass\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"42\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Create an expression tree for 1 + 2 * 3\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Print the expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Original: \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Evaluate the expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Result: \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Evaluator\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Now rewrite the expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" rewritten \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" rewriter\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Print the rewritten expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Rewritten: \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" rewritten\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Evaluate the rewritten expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Result: \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Evaluator\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"rewritten\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,n.jsx)(a.p,{children:\"We get the following output:\"}),(0,n.jsx)(a.pre,{className:\"language-ruby\",children:(0,n.jsxs)(a.code,{className:\"code-highlight language-ruby\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"user\",(0,n.jsx)(a.span,{className:\"token variable\",children:\"@MSI\"}),\" java\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"-\"}),\"record\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"-\"}),\"deconstruction\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"-\"}),\"patterns\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),\"$ \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),`gradlew run\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token operator\",children:\">\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Task\"}),\" \",(0,n.jsx)(a.span,{className:\"token symbol\",children:\":app\"}),(0,n.jsx)(a.span,{className:\"token symbol\",children:\":run\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Original\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"left\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" right\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"left\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" right\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Result\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"7\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Folding\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"left\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" right\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"left\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" right\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Folding\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Folding\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"left\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" right\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Rewriting\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"left\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" right\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"6\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Rewriting\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Rewriting\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"6\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Rewritten\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(a.span,{className:\"token constant\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"left\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"42\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" right\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token constant\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),\"value\",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"42\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token constant\",children:\"Result\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(a.span,{className:\"token number\",children:\"84\"}),`\n`]})]})}),(0,n.jsx)(a.p,{children:\"Below is the full source code for the program:\"}),(0,n.jsx)(a.pre,{className:\"language-java\",children:(0,n.jsxs)(a.code,{className:\"language-java code-highlight\",children:[(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"package\"}),\" \",(0,n.jsxs)(a.span,{className:\"token namespace\",children:[\"deconstruction\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"patterns\"]}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(a.span,{className:\"token namespace\",children:[\"java\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"util\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"})]}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsxs)(a.span,{className:\"token namespace\",children:[\"java\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"util\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"})]}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"sealed\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"interface\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"permits\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"record\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Evaluator\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Integer\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"-\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" env\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"get\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// A pass which folds simple constant expressions like 1 + 2 into 3.\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"SimpleConstantFolderPass\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Folding \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"-\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"*\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"fold\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// An interface for an expression tree rewriting pass.\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"interface\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewritingPass\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// An interface for an expression rewriter\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewriter\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsxs)(a.span,{className:\"token generics\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"<\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewritingPass\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\">\"})]}),\" passes\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewriter\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewritingPass\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\" passes\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"passes \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"List\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"passes\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Register a pass with the rewriter.\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewriter\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"register\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewritingPass\"}),\" pass\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        passes\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"pass\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Rewrite an expression tree.\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewritingPass\"}),\" pass \",(0,n.jsx)(a.span,{className:\"token operator\",children:\":\"}),\" passes\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            expr \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" pass\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token comment\",children:\"// A pass which rewrites all variables to constants.\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ConstantRewritingPass\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewritingPass\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"private\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" constantValue\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ConstantRewritingPass\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" constantValue\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"this\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"constantValue \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" constantValue\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Rewriting \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"constantValue\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ConstantFoldingPass\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"implements\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewritingPass\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Folding \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"switch\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"-\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"*\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"/\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"value\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Sub\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Div\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"left\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"right\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"int\"}),\" value\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"case\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Var\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),\" name\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"->\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"class\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"App\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(a.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"]\"}),\" args\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewriter\"}),\" rewriter \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ExprRewriter\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ConstantFoldingPass\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"                \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"ConstantRewritingPass\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"42\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Create an expression tree for 1 + 2 * 3\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" expr \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Add\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Mul\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Const\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Print the expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Original: \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Evaluate the expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Result: \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Evaluator\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Now rewrite the expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Expr\"}),\" rewritten \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"=\"}),\" rewriter\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"rewrite\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"expr\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Print the rewritten expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Rewritten: \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" rewritten\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(a.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token comment\",children:\"// Evaluate the rewritten expression tree\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token string\",children:'\"Result: \"'}),\" \",(0,n.jsx)(a.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Evaluator\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"evaluate\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),\"rewritten\",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(a.span,{className:\"token class-name\",children:\"Map\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(a.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(a.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(a.span,{className:\"code-line\",children:[(0,n.jsx)(a.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(a.h1,{id:\"get-the-source-code\",children:[(0,n.jsx)(a.a,{href:\"#get-the-source-code\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"Get the Source Code\"]}),(0,n.jsx)(a.p,{children:\"The source code to this blog post is available on GitHub:\"}),(0,n.jsx)(a.ul,{children:(0,n.jsx)(a.li,{children:(0,n.jsx)(a.a,{href:\"https://github.com/GavinRay97/java-record-patterns\",children:\"https://github.com/GavinRay97/java-record-patterns\"})})}),(0,n.jsxs)(a.h1,{id:\"attribution\",children:[(0,n.jsx)(a.a,{href:\"#attribution\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(a.span,{className:\"icon icon-link\"})}),\"Attribution\"]}),(0,n.jsxs)(a.p,{children:[\"The OpenGraph image for this blog post was taken from a Google search for \",(0,n.jsx)(a.code,{children:\"tree ast code\"}),\", and is from a blog post by \",(0,n.jsx)(a.a,{href:\"https://blog.sessionstack.com/how-javascript-works-parsing-abstract-syntax-trees-asts-5-tips-on-how-to-minimize-parse-time-abfcf7e8a0c8\",children:\"Lachezar Nickolov\"})]}),(0,n.jsx)(a.ul,{children:(0,n.jsx)(a.li,{children:(0,n.jsx)(a.a,{href:\"https://blog.sessionstack.com/how-javascript-works-parsing-abstract-syntax-trees-asts-5-tips-on-how-to-minimize-parse-time-abfcf7e8a0c8\",children:\"https://blog.sessionstack.com/how-javascript-works-parsing-abstract-syntax-trees-asts-5-tips-on-how-to-minimize-parse-time-abfcf7e8a0c8\"})})})]})}}var v=y;function x(e,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+e+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return b;})();\n;return Component;","toc":[{"value":"Preface","url":"#preface","depth":1},{"value":"What are Record Patterns?","url":"#what-are-record-patterns","depth":1},{"value":"A Simple Example","url":"#a-simple-example","depth":1},{"value":"A Person POJO, what you're used to","url":"#a-person-pojo-what-youre-used-to","depth":2},{"value":"Let's rewrite it with Records and Record Patterns","url":"#lets-rewrite-it-with-records-and-record-patterns","depth":2},{"value":"What else can we do?","url":"#what-else-can-we-do","depth":2},{"value":"The Usecase: Tree Rewriting/AST Transformations","url":"#the-usecase-tree-rewritingast-transformations","depth":1},{"value":"What is Tree Rewriting?","url":"#what-is-tree-rewriting","depth":2},{"value":"How can Record Patterns help?","url":"#how-can-record-patterns-help","depth":2},{"value":"Implementing the Rewriter","url":"#implementing-the-rewriter","depth":2},{"value":"Get the Source Code","url":"#get-the-source-code","depth":1},{"value":"Attribution","url":"#attribution","depth":1}],"frontMatter":{"readingTime":{"text":"24 min read","minutes":23.665,"time":1419900,"words":4733},"slug":"what-good-are-record-patterns","fileName":"what-good-are-record-patterns.md","title":"What good are Record Patterns in Java? An example based on Spark's Catalyst Optimizer and it's Tree Rewriting Rules","date":"2023-02-04T00:00:00.000Z","tags":["java","jdk","jvm"],"draft":false,"summary":"A tutorial on how to use Java's new Record Patterns feature to write powerful, concise pattern matching code for usecases like AST transformations and rewrite-rules in compiler passes.\n","images":["/static/images/ast-visualization.png"]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.85,"time":51000,"words":170},"slug":["default"],"fileName":"default.md","name":"Gavin Ray","avatar":"/static/images/me.png","occupation":"Code Stuff","company":"Hasura","email":"ray.gavin97@gmail.com","twitter":"https://twitter.com/GavinRayDev","linkedin":"https://www.linkedin.com","github":"https://github.com/GavinRay97","date":null}],"prev":{"title":"Building a PostgreSQL Wire Protocol Server using Vanilla, Modern Java 21","date":"2023-01-16T00:00:00.000Z","tags":["java","jdk","jvm","postgres","wire-protocol","databases","server"],"draft":false,"summary":"A dual-purpose tutorial to 1) Demonstrate how to implement the Simple Query Protocol, where Java is an implementation detail; 2) Show practical examples of most of the new features since JDK 17, including Records, Sealed Types, Pattern Matching for Switch, Virtual Threads, and Panama Foreign-Function & Memory API.\n","images":["/static/images/postgres-wire-protocol-display-image.png"],"slug":"postgres-wire-protocol-jdk-21"},"next":{"title":"The USA Public School System Failed Me: A Maths Misadventure","date":"2025-04-20T00:00:00.000Z","tags":["non-technical"],"draft":false,"summary":"A look at my experience with maths education in the USA and how it has shaped my career.","images":[],"slug":"maths-education-blog"}},"__N_SSG":true}