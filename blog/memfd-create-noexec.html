<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Bypassing noexec with memfd_create(2)</title><meta name="robots" content="follow, index"/><meta name="description" content="Using Linux&#x27;s memfd_create(2) syscall to load shared libraries and execute binaries entirely from memory, bypassing noexec restrictions without ever touching disk."/><meta property="og:url" content="https://gavinray97.github.io/blog/memfd-create-noexec"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Gavin Ray Blog"/><meta property="og:description" content="Using Linux&#x27;s memfd_create(2) syscall to load shared libraries and execute binaries entirely from memory, bypassing noexec restrictions without ever touching disk."/><meta property="og:title" content="Bypassing noexec with memfd_create(2)"/><meta property="og:image" content="https://gavinray97.github.io/static/images/memfd-create-readonly-fs.svg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/GavinRayDev"/><meta name="twitter:title" content="Bypassing noexec with memfd_create(2)"/><meta name="twitter:description" content="Using Linux&#x27;s memfd_create(2) syscall to load shared libraries and execute binaries entirely from memory, bypassing noexec restrictions without ever touching disk."/><meta name="twitter:image" content="https://gavinray97.github.io/static/images/memfd-create-readonly-fs.svg"/><link rel="canonical" href="https://gavinray97.github.io/blog/memfd-create-noexec"/><meta property="article:published_time" content="2026-03-01T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://gavinray97.github.io/blog/memfd-create-noexec"
  },
  "headline": "Bypassing noexec with memfd_create(2)",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://gavinray97.github.io/static/images/memfd-create-readonly-fs.svg"
    }
  ],
  "datePublished": "2026-03-01T00:00:00.000Z",
  "dateModified": "2026-03-01T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Gavin Ray"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Gavin Ray",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gavinray97.github.io/static/images/logo.png"
    }
  },
  "description": "Using Linux's memfd_create(2) syscall to load shared libraries and execute binaries entirely from memory, bypassing noexec restrictions without ever touching disk."
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/11bf37f52e8561b6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/11bf37f52e8561b6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-7bdcdf64985b3467.js" defer=""></script><script src="/_next/static/chunks/main-bb8a1082161dc7c2.js" defer=""></script><script src="/_next/static/chunks/pages/_app-da15d2a3f366f449.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/207-dd685ae53e609b20.js" defer=""></script><script src="/_next/static/chunks/620-407ce78f2f46843c.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-52c7b4963ecd0646.js" defer=""></script><script src="/_next/static/eamodGUKXmDYUk1Hz-h1m/_buildManifest.js" defer=""></script><script src="/_next/static/eamodGUKXmDYUk1Hz-h1m/_ssgManifest.js" defer=""></script><script src="/_next/static/eamodGUKXmDYUk1Hz-h1m/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="" href="/"><div class="flex items-center justify-between"><div class="mr-3"></div><div class="hidden h-6 text-2xl font-semibold sm:block"></div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/projects">Projects</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-24 right-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed h-full w-full cursor-auto focus:outline-none"></button><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">Projects</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2026-03-01T00:00:00.000Z">Sunday, March 1, 2026</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Bypassing noexec with memfd_create(2)</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="/static/images/me.png" width="38px" height="38px" alt="avatar" class="h-10 w-10 rounded-full"/><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Gavin Ray</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/GavinRayDev" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@GavinRayDev</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>Some time ago, I saw a post on the <code>/r/java</code> subreddit, asking about <strong>&quot;loading a shared lib from .jar directly into memory&quot;</strong>: <a target="_blank" rel="noopener noreferrer" href="https://reddit.com/r/java/comments/15lcwil/load_shared_lib_from_jar_directly_into_memory/">https://reddit.com/r/java/comments/15lcwil/load_shared_lib_from_jar_directly_into_memory/</a></p><p>Despite claims that the above is/should be impossible, it CAN be done.</p><p><a target="_blank" rel="noopener noreferrer" href="https://man7.org/linux/man-pages/man2/memfd_create.2.html">https://man7.org/linux/man-pages/man2/memfd_create.2.html</a></p><div class="relative"><pre><code class="code-highlight language-c"><span class="code-line">NAME
</span><span class="code-line">       memfd_create <span class="token operator">-</span> create an anonymous file
</span><span class="code-line">LIBRARY
</span><span class="code-line">       Standard C <span class="token function">library</span> <span class="token punctuation">(</span>libc<span class="token punctuation">,</span> <span class="token operator">-</span>lc<span class="token punctuation">)</span>
</span><span class="code-line">SYNOPSIS
</span><span class="code-line">       <span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">_GNU_SOURCE</span>         <span class="token comment">/* See feature_test_macros(7) */</span></span>
</span><span class="code-line">       <span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;sys/mman.h&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line">       <span class="token keyword">int</span> <span class="token function">memfd_create</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>Linux has a syscall, <code>memfd_create(2)</code>, that allows creating something like a virtual file descriptor. You can use the FD it returns just like any other, but it doesn&#x27;t interact with the filesystem underneath.</p><p>The reason this works is that <code>memfd</code> file descriptors are backed by anonymous pages in <code>tmpfs</code>. When you call <code>fexecve()</code> or <code>dlopen()</code> on one, the kernel maps those pages into the process&#x27;s address space directly -- it never consults the <code>noexec</code> flag of any mounted filesystem, because there IS no mounted filesystem involved. The execution permission is determined by the <code>memfd</code>&#x27;s own file seals and the process&#x27;s ability to map executable pages, rather than by mount options.</p><p>The general idea is something like:</p><ol><li>Create in-memory file descriptor</li><li>Write the bytes of an application or library into the file descriptor</li><li>Run the application or load the library</li></ol><p>Here&#x27;s a minimal proof of concept, for both an ELF binary and a shared library.</p><div class="relative"><pre><code class="code-highlight"><span class="code-line">❯ tree .
</span><span class="code-line">.
</span><span class="code-line">├── Makefile
</span><span class="code-line">├── example-library.c     # Shared lib exporting add() for testing
</span><span class="code-line">├── example-program.c     # Normal ELF binary that links against libexample-library.so
</span><span class="code-line">├── memfd-exec.c          # Loads an entire ELF binary into a memfd and executes it with fexecve()
</span><span class="code-line">└── memfd-loader.c        # Loads an .so into a memfd and calls its symbols via dlopen()/dlsym()
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-makefile"><span class="code-line">CC      <span class="token operator">=</span> gcc
</span><span class="code-line">CFLAGS  <span class="token operator">=</span> -Wall -Wextra -O2
</span><span class="code-line">
</span><span class="code-line"><span class="token symbol">all</span><span class="token punctuation">:</span> example-library.so libexample-library.so example-program memfd-loader memfd-exec
</span><span class="code-line">
</span><span class="code-line"><span class="token symbol">example-library.so</span><span class="token punctuation">:</span> example-library.c
</span><span class="code-line">    <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> -shared -fPIC -o <span class="token variable">$@</span> <span class="token variable">$&lt;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token symbol">libexample-library.so</span><span class="token punctuation">:</span> example-library.so
</span><span class="code-line">    ln -sf <span class="token variable">$&lt;</span> <span class="token variable">$@</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token symbol">example-program</span><span class="token punctuation">:</span> example-program.c libexample-library.so
</span><span class="code-line">    <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> -o <span class="token variable">$@</span> <span class="token variable">$&lt;</span> -L. -lexample-library -Wl,-rpath,<span class="token string">&#x27;$ORIGIN&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token symbol">memfd-loader</span><span class="token punctuation">:</span> memfd-loader.c example-library.so
</span><span class="code-line">    <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> -o <span class="token variable">$@</span> <span class="token variable">$&lt;</span> -ldl
</span><span class="code-line">
</span><span class="code-line"><span class="token symbol">memfd-exec</span><span class="token punctuation">:</span> memfd-exec.c example-program
</span><span class="code-line">    <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> -o <span class="token variable">$@</span> <span class="token variable">$&lt;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token symbol">clean</span><span class="token punctuation">:</span>
</span><span class="code-line">    rm -f example-library.so libexample-library.so example-program memfd-loader memfd-exec
</span><span class="code-line">
</span><span class="code-line"><span class="token builtin">.PHONY</span><span class="token punctuation">:</span> all clean
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-c"><span class="code-line"><span class="token comment">// example-library.c</span>
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-c"><span class="code-line"><span class="token comment">// example-program.c</span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-c"><span class="code-line"><span class="token comment">// memfd-loader.c</span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">_GNU_SOURCE</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;dlfcn.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;string.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;sys/mman.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// 1. Read the .so bytes</span>
</span><span class="code-line">    <span class="token keyword">int</span> lib <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;example-library.so&quot;</span><span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">struct</span> <span class="token class-name">stat</span> st<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">fstat</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span> <span class="token operator">&amp;</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">char</span> buf<span class="token punctuation">[</span>st<span class="token punctuation">.</span>st_size<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">read</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> st<span class="token punctuation">.</span>st_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">close</span><span class="token punctuation">(</span>lib<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 2. Create an anonymous in-memory file descriptor</span>
</span><span class="code-line">    <span class="token keyword">int</span> memfd <span class="token operator">=</span> <span class="token function">memfd_create</span><span class="token punctuation">(</span><span class="token string">&quot;example-library.so&quot;</span><span class="token punctuation">,</span> MFD_CLOEXEC<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 3. Write the library bytes into it</span>
</span><span class="code-line">    <span class="token function">write</span><span class="token punctuation">(</span>memfd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> st<span class="token punctuation">.</span>st_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 4. dlopen via /proc/self/fd/&lt;N&gt; - no filesystem path needed</span>
</span><span class="code-line">    <span class="token keyword">char</span> path<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">snprintf</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;/proc/self/fd/%d&quot;</span><span class="token punctuation">,</span> memfd<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">void</span> <span class="token operator">*</span>handle <span class="token operator">=</span> <span class="token function">dlopen</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> RTLD_NOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>handle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;dlopen: %s\n&quot;</span><span class="token punctuation">,</span> <span class="token function">dlerror</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 5. Resolve + call the symbol</span>
</span><span class="code-line">    <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>add<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">dlsym</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;add(3, 4) = %d\n&quot;</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token function">dlclose</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">close</span><span class="token punctuation">(</span>memfd<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-c"><span class="code-line"><span class="token comment">// memfd-exec.c</span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">define</span> <span class="token macro-name">_GNU_SOURCE</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;sys/mman.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
</span><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token keyword directive">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// 1. Read the binary bytes</span>
</span><span class="code-line">    <span class="token keyword">int</span> bin <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;example-program&quot;</span><span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">struct</span> <span class="token class-name">stat</span> st<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">fstat</span><span class="token punctuation">(</span>bin<span class="token punctuation">,</span> <span class="token operator">&amp;</span>st<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">char</span> buf<span class="token punctuation">[</span>st<span class="token punctuation">.</span>st_size<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">read</span><span class="token punctuation">(</span>bin<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> st<span class="token punctuation">.</span>st_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">close</span><span class="token punctuation">(</span>bin<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 2. Create anonymous in-memory fd</span>
</span><span class="code-line">    <span class="token keyword">int</span> memfd <span class="token operator">=</span> <span class="token function">memfd_create</span><span class="token punctuation">(</span><span class="token string">&quot;example-program&quot;</span><span class="token punctuation">,</span> MFD_CLOEXEC<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 3. Write binary into it</span>
</span><span class="code-line">    <span class="token function">write</span><span class="token punctuation">(</span>memfd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> st<span class="token punctuation">.</span>st_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 4. Execute directly from the fd</span>
</span><span class="code-line">    <span class="token comment">//    Note: fexecve replaces the process image, so $ORIGIN in any rpath</span>
</span><span class="code-line">    <span class="token comment">//    would resolve to /proc/self/fd/ which doesn&#x27;t contain our .so.</span>
</span><span class="code-line">    <span class="token comment">//    We use LD_LIBRARY_PATH as a simple workaround.</span>
</span><span class="code-line">    <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;example-program&quot;</span><span class="token punctuation">,</span> <span class="token constant">NULL</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">char</span> <span class="token operator">*</span>envp<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;LD_LIBRARY_PATH=.&quot;</span><span class="token punctuation">,</span> <span class="token constant">NULL</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Executing example-program from memfd...\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token function">fexecve</span><span class="token punctuation">(</span>memfd<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> envp<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;fexecve&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><p>You should be able to run the ELF binary or invoke the shared lib using the <code>memfd</code> example apps:</p><p>First, to prove I&#x27;m not pulling tricks here...</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">projects/memory-loader-example via C v13.3.0-gcc
</span><span class="code-line">❯ <span class="token function">grep</span> <span class="token string">&#x27; /proc &#x27;</span> /proc/mounts <span class="token operator">|</span> <span class="token function">grep</span> -q <span class="token string">&#x27;noexec&#x27;</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name builtin">echo</span> <span class="token string">&quot;noexec is enabled&quot;</span> <span class="token operator">||</span> <span class="token class-name builtin">echo</span> <span class="token string">&quot;noexec is not enabled&quot;</span>
</span><span class="code-line">noexec is enabled
</span><span class="code-line">
</span><span class="code-line">projects/memory-loader-example via C v13.3.0-gcc
</span><span class="code-line">❯ <span class="token function">grep</span> <span class="token string">&#x27; /proc &#x27;</span> /proc/mounts <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#x27;noexec&#x27;</span>
</span><span class="code-line">proc /proc proc rw,nosuid,nodev,noexec,noatime <span class="token number">0</span> <span class="token number">0</span>
</span></code></pre></div><p>And with that, we confirm:</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line">projects/memory-loader-example via C v13.3.0-gcc
</span><span class="code-line">❯ ./example-program
</span><span class="code-line"><span class="token number">7</span>
</span><span class="code-line">
</span><span class="code-line">projects/memory-loader-example via C v13.3.0-gcc
</span><span class="code-line">❯ ./memfd-loader
</span><span class="code-line">add<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">7</span>
</span><span class="code-line">
</span><span class="code-line">projects/memory-loader-example via C v13.3.0-gcc
</span><span class="code-line">❯ ./memfd-exec
</span><span class="code-line">Executing example-program from memfd<span class="token punctuation">..</span>.
</span><span class="code-line"><span class="token number">7</span>
</span></code></pre></div><p>As someone mentions in the Reddit thread, there are patches for both Chrome and the kernel to prevent this behavior:</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://issuetracker.google.com/issues/40054993">https://issuetracker.google.com/issues/40054993</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://lore.kernel.org/kernel-hardening/20201203173118.379271-1-mic@digikod.net/T/">https://lore.kernel.org/kernel-hardening/20201203173118.379271-1-mic@digikod.net/T/</a></li></ul><p>It&#x27;s worth noting that as of kernel 6.3, the <code>vm.memfd_noexec</code> sysctl was introduced to restrict executable memfds. At level 1, <code>memfd_create()</code> without <code>MFD_NOEXEC_SEAL</code> emits a warning; at level 2, it&#x27;s denied outright. Most distros still ship with this at 0 (unrestricted), but hardened configs and container runtimes are starting to lock it down.</p><h1 id="addendum-solving-the-original-problem"><a href="#addendum-solving-the-original-problem" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Addendum: Solving the original problem</h1><p>In case you actually want to accomplish the same thing as the original /r/java user (loading a native library from memory without extracting it to disk) the following does so using JDK 23&#x27;s Foreign Function &amp; Memory (FFM) API to call <code>memfd_create</code> and <code>dlopen</code>/<code>dlsym</code> directly, with no JNI involved:</p><div class="relative"><pre><code class="code-highlight language-java"><span class="code-line"><span class="token comment">// java --enable-preview --source 23 --enable-native-access=ALL-UNNAMED LoadFromMemory.java &lt; example-library.so</span>
</span><span class="code-line"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token class-name">ByteBuffer</span> sharedLibContents <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">.</span><span class="token function">readAllBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token class-name">Arena</span> arena <span class="token operator">=</span> <span class="token class-name">Arena</span><span class="token punctuation">.</span><span class="token function">ofAuto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">Linker</span> linker <span class="token operator">=</span> <span class="token class-name">Linker</span><span class="token punctuation">.</span><span class="token function">nativeLinker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">SymbolLookup</span> lookup <span class="token operator">=</span> linker<span class="token punctuation">.</span><span class="token function">defaultLookup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Get &quot;memfd_create&quot; handle from libc</span>
</span><span class="code-line">    <span class="token class-name">MethodHandle</span> memfdCreate <span class="token operator">=</span> linker<span class="token punctuation">.</span><span class="token function">downcallHandle</span><span class="token punctuation">(</span>
</span><span class="code-line">            lookup<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;memfd_create&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token class-name">FunctionDescriptor</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>JAVA_INT<span class="token punctuation">,</span> <span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>ADDRESS<span class="token punctuation">,</span> <span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>JAVA_INT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Create memory file descriptor</span>
</span><span class="code-line">    <span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> memfdCreate<span class="token punctuation">.</span><span class="token function">invokeExact</span><span class="token punctuation">(</span>arena<span class="token punctuation">.</span><span class="token function">allocateFrom</span><span class="token punctuation">(</span><span class="token string">&quot;example-library&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Write shared library to memory file descriptor</span>
</span><span class="code-line">    <span class="token class-name">String</span> fdPath <span class="token operator">=</span> <span class="token string">&quot;/proc/self/fd/&quot;</span> <span class="token operator">+</span> fd<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token keyword">var</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>fdPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        fos<span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>sharedLibContents<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Get &quot;dlopen&quot; handle from libc</span>
</span><span class="code-line">    <span class="token class-name">MethodHandle</span> dlopen <span class="token operator">=</span> linker<span class="token punctuation">.</span><span class="token function">downcallHandle</span><span class="token punctuation">(</span>
</span><span class="code-line">            lookup<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;dlopen&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token class-name">FunctionDescriptor</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>ADDRESS<span class="token punctuation">,</span> <span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>ADDRESS<span class="token punctuation">,</span> <span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>JAVA_INT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Load shared library from memfd</span>
</span><span class="code-line">    <span class="token class-name">MemorySegment</span> handle <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MemorySegment</span><span class="token punctuation">)</span> dlopen<span class="token punctuation">.</span><span class="token function">invokeExact</span><span class="token punctuation">(</span>arena<span class="token punctuation">.</span><span class="token function">allocateFrom</span><span class="token punctuation">(</span>fdPath<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Get &quot;dlsym&quot; handle and resolve &quot;add&quot; function</span>
</span><span class="code-line">    <span class="token class-name">MethodHandle</span> dlsym <span class="token operator">=</span> linker<span class="token punctuation">.</span><span class="token function">downcallHandle</span><span class="token punctuation">(</span>
</span><span class="code-line">            lookup<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;dlsym&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token class-name">FunctionDescriptor</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>ADDRESS<span class="token punctuation">,</span> <span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>ADDRESS<span class="token punctuation">,</span> <span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>ADDRESS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token class-name">MemorySegment</span> addAddr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MemorySegment</span><span class="token punctuation">)</span> dlsym<span class="token punctuation">.</span><span class="token function">invokeExact</span><span class="token punctuation">(</span>handle<span class="token punctuation">,</span> arena<span class="token punctuation">.</span><span class="token function">allocateFrom</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">MethodHandle</span> add <span class="token operator">=</span> linker<span class="token punctuation">.</span><span class="token function">downcallHandle</span><span class="token punctuation">(</span>addAddr<span class="token punctuation">,</span>
</span><span class="code-line">            <span class="token class-name">FunctionDescriptor</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>JAVA_INT<span class="token punctuation">,</span> <span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>JAVA_INT<span class="token punctuation">,</span> <span class="token class-name">ValueLayout</span><span class="token punctuation">.</span>JAVA_INT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// Invoke &quot;add&quot; function</span>
</span><span class="code-line">    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> add<span class="token punctuation">.</span><span class="token function">invokeExact</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;1 + 2 = &quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><hr/><p><strong>AI Use Disclaimer:</strong> <code>claude code</code> was used to generate the <a href="/static/images/memfd-create-readonly-fs.svg">OpenGraph SVG image</a></p><p>No part of the prose was machine-generated. You will not find machine-written prose on this blog. I consider it deeply disrespectful.</p></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Fgavinray97.github.io%2Fblog%2Fmemfd-create-noexec">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/GavinRay97/GavinRay97.github.io/blob/master/data/blog/memfd-create-noexec.md">View on GitHub</a></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/linux">linux</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/c">c</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/systems-programming">systems-programming</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/java">java</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Previous Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/llm-build-cheaper-than-searching">Disposable Software: When generating code costs less than finding it</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:ray.gavin97@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/GavinRay97"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/GavinRayDev"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 0 1-2.825.775 4.958 4.958 0 0 0 2.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 0 0-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 0 0-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 0 1-2.228-.616v.06a4.923 4.923 0 0 0 3.946 4.827 4.996 4.996 0 0 1-2.212.085 4.936 4.936 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 0 0 7.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0 0 24 4.59z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Gavin Ray</div><div> • </div><div>© 2026</div><div> • </div><a href="/">Gavin Ray Blog</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var t=a=\u003el(a,\"__esModule\",{value:!0});var u=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{t(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of p(s))!h.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026l(a,e,{get:()=\u003es[e],enumerable:!(c=d(s,e))||c.enumerable});return a},f=a=\u003ek(t(l(a!=null?r(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=u((x,i)=\u003e{i.exports=_jsx_runtime});var v={};N(v,{default:()=\u003eb,frontmatter:()=\u003ey});var n=f(o()),y={title:\"Bypassing noexec with memfd_create(2)\",date:\"2026-02-29\",tags:[\"linux\",\"c\",\"systems-programming\",\"java\"],draft:!1,summary:\"Using Linux's memfd_create(2) syscall to load shared libraries and execute binaries entirely from memory, bypassing noexec restrictions without ever touching disk.\",images:[\"/static/images/memfd-create-readonly-fs.svg\"]};function g(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({p:\"p\",code:\"code\",strong:\"strong\",a:\"a\",pre:\"pre\",span:\"span\",ol:\"ol\",li:\"li\",ul:\"ul\",h1:\"h1\",hr:\"hr\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"Some time ago, I saw a post on the \",(0,n.jsx)(e.code,{children:\"/r/java\"}),\" subreddit, asking about \",(0,n.jsx)(e.strong,{children:'\"loading a shared lib from .jar directly into memory\"'}),\": \",(0,n.jsx)(e.a,{href:\"https://reddit.com/r/java/comments/15lcwil/load_shared_lib_from_jar_directly_into_memory/\",children:\"https://reddit.com/r/java/comments/15lcwil/load_shared_lib_from_jar_directly_into_memory/\"})]}),(0,n.jsx)(e.p,{children:\"Despite claims that the above is/should be impossible, it CAN be done.\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://man7.org/linux/man-pages/man2/memfd_create.2.html\",children:\"https://man7.org/linux/man-pages/man2/memfd_create.2.html\"})}),(0,n.jsx)(e.pre,{className:\"language-c\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-c\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`NAME\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"       memfd_create \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),` create an anonymous file\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`LIBRARY\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"       Standard C \",(0,n.jsx)(e.span,{className:\"token function\",children:\"library\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"libc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\"lc\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`SYNOPSIS\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"       \",(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"define\"}),\" \",(0,n.jsx)(e.span,{className:\"token macro-name\",children:\"_GNU_SOURCE\"}),\"         \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"/* See feature_test_macros(7) */\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"       \",(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003csys/mman.h\u003e\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"       \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"memfd_create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"unsigned\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" flags\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"Linux has a syscall, \",(0,n.jsx)(e.code,{children:\"memfd_create(2)\"}),\", that allows creating something like a virtual file descriptor. You can use the FD it returns just like any other, but it doesn't interact with the filesystem underneath.\"]}),(0,n.jsxs)(e.p,{children:[\"The reason this works is that \",(0,n.jsx)(e.code,{children:\"memfd\"}),\" file descriptors are backed by anonymous pages in \",(0,n.jsx)(e.code,{children:\"tmpfs\"}),\". When you call \",(0,n.jsx)(e.code,{children:\"fexecve()\"}),\" or \",(0,n.jsx)(e.code,{children:\"dlopen()\"}),\" on one, the kernel maps those pages into the process's address space directly -- it never consults the \",(0,n.jsx)(e.code,{children:\"noexec\"}),\" flag of any mounted filesystem, because there IS no mounted filesystem involved. The execution permission is determined by the \",(0,n.jsx)(e.code,{children:\"memfd\"}),\"'s own file seals and the process's ability to map executable pages, rather than by mount options.\"]}),(0,n.jsx)(e.p,{children:\"The general idea is something like:\"}),(0,n.jsxs)(e.ol,{children:[(0,n.jsx)(e.li,{children:\"Create in-memory file descriptor\"}),(0,n.jsx)(e.li,{children:\"Write the bytes of an application or library into the file descriptor\"}),(0,n.jsx)(e.li,{children:\"Run the application or load the library\"})]}),(0,n.jsx)(e.p,{children:\"Here's a minimal proof of concept, for both an ELF binary and a shared library.\"}),(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u276F tree .\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`.\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 Makefile\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 example-library.c     # Shared lib exporting add() for testing\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 example-program.c     # Normal ELF binary that links against libexample-library.so\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u251C\\u2500\\u2500 memfd-exec.c          # Loads an entire ELF binary into a memfd and executes it with fexecve()\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u2514\\u2500\\u2500 memfd-loader.c        # Loads an .so into a memfd and calls its symbols via dlopen()/dlsym()\n`})]})}),(0,n.jsx)(e.pre,{className:\"language-makefile\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-makefile\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"CC      \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` gcc\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"CFLAGS  \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),` -Wall -Wextra -O2\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token symbol\",children:\"all\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` example-library.so libexample-library.so example-program memfd-loader memfd-exec\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token symbol\",children:\"example-library.so\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` example-library.c\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"CC\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"CFLAGS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" -shared -fPIC -o \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$@\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\u003c\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token symbol\",children:\"libexample-library.so\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` example-library.so\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    ln -sf \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$@\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token symbol\",children:\"example-program\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` example-program.c libexample-library.so\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"CC\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"CFLAGS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" -o \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$@\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\u003c\"}),\" -L. -lexample-library -Wl,-rpath,\",(0,n.jsx)(e.span,{className:\"token string\",children:\"'$ORIGIN'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token symbol\",children:\"memfd-loader\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` memfd-loader.c example-library.so\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"CC\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"CFLAGS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" -o \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$@\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\u003c\"}),` -ldl\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token symbol\",children:\"memfd-exec\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` memfd-exec.c example-program\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"CC\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"CFLAGS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" -o \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$@\"}),\" \",(0,n.jsx)(e.span,{className:\"token variable\",children:\"$\u003c\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token symbol\",children:\"clean\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`    rm -f example-library.so libexample-library.so example-program memfd-loader memfd-exec\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token builtin\",children:\".PHONY\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),` all clean\n`]})]})}),(0,n.jsx)(e.pre,{className:\"language-c\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-c\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// example-library.c\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" a \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.pre,{className:\"language-c\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-c\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// example-program.c\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cstdio.h\u003e\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" a\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" b\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"printf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"%d\\\\n\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.pre,{className:\"language-c\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-c\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// memfd-loader.c\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"define\"}),\" \",(0,n.jsx)(e.span,{className:\"token macro-name\",children:\"_GNU_SOURCE\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cdlfcn.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cstdio.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cstring.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003csys/mman.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cunistd.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cfcntl.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003csys/stat.h\u003e\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 1. Read the .so bytes\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" lib \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"open\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"example-library.so\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" O_RDONLY\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"stat\"}),\" st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"fstat\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"lib\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"st_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"read\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"lib\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"st_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"close\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"lib\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 2. Create an anonymous in-memory file descriptor\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" memfd \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"memfd_create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"example-library.so\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" MFD_CLOEXEC\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 3. Write the library bytes into it\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"write\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"memfd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"st_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 4. dlopen via /proc/self/fd/\u003cN\u003e - no filesystem path needed\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"snprintf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"sizeof\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/proc/self/fd/%d\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" memfd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"handle \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"dlopen\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"path\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" RTLD_NOW\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"!\"}),\"handle\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token function\",children:\"fprintf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token constant\",children:\"stderr\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"dlopen: %s\\\\n\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"dlerror\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 5. Resolve + call the symbol\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"add\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"dlsym\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"handle\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"add\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"printf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"add(3, 4) = %d\\\\n\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"add\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"dlclose\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"handle\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"close\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"memfd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.pre,{className:\"language-c\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-c\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// memfd-exec.c\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"define\"}),\" \",(0,n.jsx)(e.span,{className:\"token macro-name\",children:\"_GNU_SOURCE\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cstdio.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cfcntl.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003csys/mman.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003csys/stat.h\u003e\"})]}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsxs)(e.span,{className:\"token macro property\",children:[(0,n.jsx)(e.span,{className:\"token directive-hash\",children:\"#\"}),(0,n.jsx)(e.span,{className:\"token keyword directive\",children:\"include\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"\u003cunistd.h\u003e\"})]}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 1. Read the binary bytes\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" bin \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"open\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"example-program\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" O_RDONLY\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"stat\"}),\" st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"fstat\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"st_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"read\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"st_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"close\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"bin\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 2. Create anonymous in-memory fd\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" memfd \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"memfd_create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"example-program\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" MFD_CLOEXEC\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 3. Write binary into it\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"write\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"memfd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" buf\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" st\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"st_size\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// 4. Execute directly from the fd\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//    Note: fexecve replaces the process image, so $ORIGIN in any rpath\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//    would resolve to /proc/self/fd/ which doesn't contain our .so.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//    We use LD_LIBRARY_PATH as a simple workaround.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"argv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"example-program\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"NULL\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"char\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"envp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"LD_LIBRARY_PATH=.\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"NULL\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"printf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"Executing example-program from memfd...\\\\n\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"fexecve\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"memfd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" argv\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" envp\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"perror\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"fexecve\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"You should be able to run the ELF binary or invoke the shared lib using the \",(0,n.jsx)(e.code,{children:\"memfd\"}),\" example apps:\"]}),(0,n.jsx)(e.p,{children:\"First, to prove I'm not pulling tricks here...\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`projects/memory-loader-example via C v13.3.0-gcc\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\\u276F \",(0,n.jsx)(e.span,{className:\"token function\",children:\"grep\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"' /proc '\"}),\" /proc/mounts \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"grep\"}),\" -q \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'noexec'\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name builtin\",children:\"echo\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"noexec is enabled\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"||\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name builtin\",children:\"echo\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"noexec is not enabled\"'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`noexec is enabled\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`projects/memory-loader-example via C v13.3.0-gcc\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\\u276F \",(0,n.jsx)(e.span,{className:\"token function\",children:\"grep\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"' /proc '\"}),\" /proc/mounts \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"grep\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'noexec'\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"proc /proc proc rw,nosuid,nodev,noexec,noatime \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"And with that, we confirm:\"}),(0,n.jsx)(e.pre,{className:\"language-bash\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-bash\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`projects/memory-loader-example via C v13.3.0-gcc\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u276F ./example-program\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"7\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`projects/memory-loader-example via C v13.3.0-gcc\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u276F ./memfd-loader\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"add\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),\", \",(0,n.jsx)(e.span,{className:\"token number\",children:\"4\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"7\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`projects/memory-loader-example via C v13.3.0-gcc\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\\u276F ./memfd-exec\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"Executing example-program from memfd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"..\"}),`.\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token number\",children:\"7\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"As someone mentions in the Reddit thread, there are patches for both Chrome and the kernel to prevent this behavior:\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://issuetracker.google.com/issues/40054993\",children:\"https://issuetracker.google.com/issues/40054993\"})}),(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://lore.kernel.org/kernel-hardening/20201203173118.379271-1-mic@digikod.net/T/\",children:\"https://lore.kernel.org/kernel-hardening/20201203173118.379271-1-mic@digikod.net/T/\"})})]}),(0,n.jsxs)(e.p,{children:[\"It's worth noting that as of kernel 6.3, the \",(0,n.jsx)(e.code,{children:\"vm.memfd_noexec\"}),\" sysctl was introduced to restrict executable memfds. At level 1, \",(0,n.jsx)(e.code,{children:\"memfd_create()\"}),\" without \",(0,n.jsx)(e.code,{children:\"MFD_NOEXEC_SEAL\"}),\" emits a warning; at level 2, it's denied outright. Most distros still ship with this at 0 (unrestricted), but hardened configs and container runtimes are starting to lock it down.\"]}),(0,n.jsxs)(e.h1,{id:\"addendum-solving-the-original-problem\",children:[(0,n.jsx)(e.a,{href:\"#addendum-solving-the-original-problem\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Addendum: Solving the original problem\"]}),(0,n.jsxs)(e.p,{children:[\"In case you actually want to accomplish the same thing as the original /r/java user (loading a native library from memory without extracting it to disk) the following does so using JDK 23's Foreign Function \u0026 Memory (FFM) API to call \",(0,n.jsx)(e.code,{children:\"memfd_create\"}),\" and \",(0,n.jsx)(e.code,{children:\"dlopen\"}),\"/\",(0,n.jsx)(e.code,{children:\"dlsym\"}),\" directly, with no JNI involved:\"]}),(0,n.jsx)(e.pre,{className:\"language-java\",children:(0,n.jsxs)(e.code,{className:\"code-highlight language-java\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// java --enable-preview --source 23 --enable-native-access=ALL-UNNAMED LoadFromMemory.java \u003c example-library.so\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"public\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"static\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"main\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" args\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"throws\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Throwable\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ByteBuffer\"}),\" sharedLibContents \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ByteBuffer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"wrap\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"in\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"readAllBytes\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Arena\"}),\" arena \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Arena\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"ofAuto\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Linker\"}),\" linker \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"Linker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"nativeLinker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"SymbolLookup\"}),\" lookup \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" linker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"defaultLookup\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:'// Get \"memfd_create\" handle from libc'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MethodHandle\"}),\" memfdCreate \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" linker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"downcallHandle\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            lookup\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"find\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"memfd_create\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"orElseThrow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FunctionDescriptor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"JAVA_INT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ADDRESS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"JAVA_INT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Create memory file descriptor\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" fd \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" memfdCreate\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"invokeExact\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arena\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"allocateFrom\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"example-library\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Write shared library to memory file descriptor\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"String\"}),\" fdPath \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"/proc/self/fd/\"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" fd\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"try\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" fos \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FileOutputStream\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"fdPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"        fos\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getChannel\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"write\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"sharedLibContents\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:'// Get \"dlopen\" handle from libc'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MethodHandle\"}),\" dlopen \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" linker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"downcallHandle\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            lookup\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"find\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"dlopen\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"orElseThrow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FunctionDescriptor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ADDRESS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ADDRESS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"JAVA_INT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Load shared library from memfd\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MemorySegment\"}),\" handle \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MemorySegment\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" dlopen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"invokeExact\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"arena\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"allocateFrom\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"fdPath\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:'// Get \"dlsym\" handle and resolve \"add\" function'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MethodHandle\"}),\" dlsym \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" linker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"downcallHandle\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            lookup\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"find\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"dlsym\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"orElseThrow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FunctionDescriptor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ADDRESS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ADDRESS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ADDRESS\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MemorySegment\"}),\" addAddr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MemorySegment\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" dlsym\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"invokeExact\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"handle\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" arena\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"allocateFrom\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"add\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"MethodHandle\"}),\" add \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" linker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"downcallHandle\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"addAddr\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"            \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"FunctionDescriptor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"of\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"JAVA_INT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"JAVA_INT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"ValueLayout\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"JAVA_INT\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:'// Invoke \"add\" function'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),\" result \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" add\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"invokeExact\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token class-name\",children:\"System\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"out\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"println\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"1 + 2 = \"'}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" result\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.hr,{}),(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"AI Use Disclaimer:\"}),\" \",(0,n.jsx)(e.code,{children:\"claude code\"}),\" was used to generate the \",(0,n.jsx)(e.a,{href:\"/static/images/memfd-create-readonly-fs.svg\",children:\"OpenGraph SVG image\"})]}),(0,n.jsx)(e.p,{children:\"No part of the prose was machine-generated. You will not find machine-written prose on this blog. I consider it deeply disrespectful.\"})]})}}var b=g;return v;})();\n;return Component;","toc":[{"value":"Addendum: Solving the original problem","url":"#addendum-solving-the-original-problem","depth":1}],"frontMatter":{"readingTime":{"text":"10 min read","minutes":9.82,"time":589200,"words":1964},"slug":"memfd-create-noexec","fileName":"memfd-create-noexec.md","title":"Bypassing noexec with memfd_create(2)","date":"2026-03-01T00:00:00.000Z","tags":["linux","c","systems-programming","java"],"draft":false,"summary":"Using Linux's memfd_create(2) syscall to load shared libraries and execute binaries entirely from memory, bypassing noexec restrictions without ever touching disk.","images":["/static/images/memfd-create-readonly-fs.svg"]}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.9,"time":54000,"words":180},"slug":["default"],"fileName":"default.md","name":"Gavin Ray","avatar":"/static/images/me.png","occupation":"Code Stuff","company":"PromptQL (formerly known as Hasura)","email":"ray.gavin97@gmail.com","twitter":"https://twitter.com/GavinRayDev","linkedin":"https://www.linkedin.com","github":"https://github.com/GavinRay97","date":null}],"prev":{"title":"Disposable Software: When generating code costs less than finding it","date":"2026-02-28T00:00:00.000Z","tags":["non-technical","ai","opinion","software-engineering"],"draft":false,"summary":"LLMs have made generating code nearly free, but maintaining it hasn't changed. On the growing plague of code that shouldn't exist and the discipline of searching before building.","images":["/static/images/llm-build-vs-search.svg"],"slug":"llm-build-cheaper-than-searching"},"next":null},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["memfd-create-noexec"]},"buildId":"eamodGUKXmDYUk1Hz-h1m","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>